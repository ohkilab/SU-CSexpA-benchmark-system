{"name":"exp-a","desc":"","tables":[{"name":"contests","type":"BASE TABLE","comment":"コンテスト(予選・本戦を管理するため)","columns":[{"name":"id","type":"bigint","nullable":false,"default":null,"comment":"コンテストID(PK)","extra_def":"auto_increment"},{"name":"title","type":"varchar(255)","nullable":false,"default":null,"comment":"コンテスト名 e.g.) 2023 情報科学実験A ベンチマークコンテスト 予選"},{"name":"start_at","type":"timestamp","nullable":false,"default":null,"comment":"開始日時"},{"name":"end_at","type":"timestamp","nullable":false,"default":null,"comment":"終了日時"},{"name":"submit_limit","type":"bigint","nullable":false,"default":null,"comment":"グループが提出できる回数(SUCCESS のみカウントされる)"},{"name":"slug","type":"varchar(255)","nullable":false,"default":null,"comment":"コンテストの識別子(unique) e.g.) exp-a-2023-qual."},{"name":"tag_selection_logic","type":"enum('auto','manual')","nullable":false,"default":null,"comment":"auto: {slug}/random.txt から選出される / manual: {slug}/\\d.txt から選出される(\\d は試行回数)"},{"name":"validator","type":"varchar(255)","nullable":false,"default":null,"comment":"レスポンスの validator。実装されている validator は proto に定義されている。"},{"name":"time_limit_per_task","type":"bigint","nullable":true,"default":"30000000000","comment":"タスクごとの制限時間(ms)"},{"name":"created_at","type":"timestamp","nullable":false,"default":null,"comment":"作成日時"},{"name":"updated_at","type":"timestamp","nullable":true,"default":null,"comment":"更新日時"}],"indexes":[{"name":"PRIMARY","def":"PRIMARY KEY (id) USING BTREE","table":"contests","columns":["id"],"comment":""},{"name":"contest_slug","def":"UNIQUE KEY contest_slug (slug) USING BTREE","table":"contests","columns":["slug"],"comment":""},{"name":"slug","def":"UNIQUE KEY slug (slug) USING BTREE","table":"contests","columns":["slug"],"comment":""}],"constraints":[{"name":"contest_slug","type":"UNIQUE","def":"UNIQUE KEY contest_slug (slug)","table":"contests","referenced_table":null,"columns":["slug"],"referenced_columns":null,"comment":""},{"name":"PRIMARY","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"contests","referenced_table":null,"columns":["id"],"referenced_columns":null,"comment":""},{"name":"slug","type":"UNIQUE","def":"UNIQUE KEY slug (slug)","table":"contests","referenced_table":null,"columns":["slug"],"referenced_columns":null,"comment":""}],"triggers":[],"def":"CREATE TABLE `contests` (\n  `id` bigint NOT NULL AUTO_INCREMENT,\n  `title` varchar(255) COLLATE utf8mb4_bin NOT NULL,\n  `start_at` timestamp NOT NULL,\n  `end_at` timestamp NOT NULL,\n  `submit_limit` bigint NOT NULL,\n  `slug` varchar(255) COLLATE utf8mb4_bin NOT NULL,\n  `tag_selection_logic` enum('auto','manual') COLLATE utf8mb4_bin NOT NULL,\n  `validator` varchar(255) COLLATE utf8mb4_bin NOT NULL,\n  `time_limit_per_task` bigint DEFAULT '30000000000',\n  `created_at` timestamp NOT NULL,\n  `updated_at` timestamp NULL DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `slug` (`slug`),\n  UNIQUE KEY `contest_slug` (`slug`)\n) ENGINE=InnoDB AUTO_INCREMENT=[Redacted by tbls] DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin"},{"name":"groups","type":"BASE TABLE","comment":"グループ(ユーザ)","columns":[{"name":"id","type":"bigint","nullable":false,"default":null,"comment":"グループID(PK)","extra_def":"auto_increment"},{"name":"name","type":"varchar(255)","nullable":false,"default":null,"comment":"グループ名"},{"name":"role","type":"varchar(255)","nullable":false,"default":null,"comment":"グループの役割(ADMIN, CONTESTANT, GUEST)。proto に定義されている。"},{"name":"year","type":"bigint","nullable":false,"default":null,"comment":"グループの年度"},{"name":"encrypted_password","type":"varchar(255)","nullable":false,"default":null,"comment":"パスワードのハッシュ"},{"name":"created_at","type":"timestamp","nullable":false,"default":null,"comment":"作成日時"},{"name":"updated_at","type":"timestamp","nullable":true,"default":null,"comment":"更新日時"}],"indexes":[{"name":"PRIMARY","def":"PRIMARY KEY (id) USING BTREE","table":"groups","columns":["id"],"comment":""},{"name":"group_name_year","def":"UNIQUE KEY group_name_year (name, year) USING BTREE","table":"groups","columns":["name","year"],"comment":"name と year の unique index"}],"constraints":[{"name":"group_name_year","type":"UNIQUE","def":"UNIQUE KEY group_name_year (name, year)","table":"groups","referenced_table":null,"columns":["name","year"],"referenced_columns":null,"comment":""},{"name":"PRIMARY","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"groups","referenced_table":null,"columns":["id"],"referenced_columns":null,"comment":""}],"triggers":[],"def":"CREATE TABLE `groups` (\n  `id` bigint NOT NULL AUTO_INCREMENT,\n  `name` varchar(255) COLLATE utf8mb4_bin NOT NULL,\n  `role` varchar(255) COLLATE utf8mb4_bin NOT NULL,\n  `year` bigint NOT NULL,\n  `encrypted_password` varchar(255) COLLATE utf8mb4_bin NOT NULL,\n  `created_at` timestamp NOT NULL,\n  `updated_at` timestamp NULL DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `group_name_year` (`name`,`year`)\n) ENGINE=InnoDB AUTO_INCREMENT=[Redacted by tbls] DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin"},{"name":"submits","type":"BASE TABLE","comment":"グループの提出を管理するテーブル","columns":[{"name":"id","type":"bigint","nullable":false,"default":null,"comment":"提出ID(PK)","extra_def":"auto_increment"},{"name":"url","type":"varchar(255)","nullable":false,"default":null,"comment":"提出の URL"},{"name":"score","type":"bigint","nullable":true,"default":null,"comment":"task_results の合計スコア"},{"name":"language","type":"enum('php','go','rust','javascript','csharp','cpp','ruby','python')","nullable":true,"default":null,"comment":""},{"name":"message","type":"varchar(255)","nullable":true,"default":null,"comment":"connection_failed や validation_error などのメッセージ"},{"name":"status","type":"varchar(255)","nullable":false,"default":null,"comment":"ステータス。proto に定義されている。"},{"name":"task_num","type":"bigint","nullable":false,"default":null,"comment":"タスクの数"},{"name":"submited_at","type":"timestamp","nullable":false,"default":null,"comment":"提出日時"},{"name":"completed_at","type":"timestamp","nullable":true,"default":null,"comment":"ベンチマーク完了日時"},{"name":"updated_at","type":"timestamp","nullable":true,"default":null,"comment":""},{"name":"contest_submits","type":"bigint","nullable":true,"default":null,"comment":""},{"name":"group_submits","type":"bigint","nullable":true,"default":null,"comment":""}],"indexes":[{"name":"submits_contests_submits","def":"KEY submits_contests_submits (contest_submits) USING BTREE","table":"submits","columns":["contest_submits"],"comment":""},{"name":"submits_groups_submits","def":"KEY submits_groups_submits (group_submits) USING BTREE","table":"submits","columns":["group_submits"],"comment":""},{"name":"PRIMARY","def":"PRIMARY KEY (id) USING BTREE","table":"submits","columns":["id"],"comment":""}],"constraints":[{"name":"PRIMARY","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"submits","referenced_table":null,"columns":["id"],"referenced_columns":null,"comment":""},{"name":"submits_contests_submits","type":"FOREIGN KEY","def":"FOREIGN KEY (contest_submits) REFERENCES contests (id)","table":"submits","referenced_table":"contests","columns":["contest_submits"],"referenced_columns":["id"],"comment":""},{"name":"submits_groups_submits","type":"FOREIGN KEY","def":"FOREIGN KEY (group_submits) REFERENCES groups (id)","table":"submits","referenced_table":"groups","columns":["group_submits"],"referenced_columns":["id"],"comment":""}],"triggers":[],"def":"CREATE TABLE `submits` (\n  `id` bigint NOT NULL AUTO_INCREMENT,\n  `url` varchar(255) COLLATE utf8mb4_bin NOT NULL,\n  `score` bigint DEFAULT NULL,\n  `language` enum('php','go','rust','javascript','csharp','cpp','ruby','python') COLLATE utf8mb4_bin DEFAULT NULL,\n  `message` varchar(255) COLLATE utf8mb4_bin DEFAULT NULL,\n  `status` varchar(255) COLLATE utf8mb4_bin NOT NULL,\n  `task_num` bigint NOT NULL,\n  `submited_at` timestamp NOT NULL,\n  `completed_at` timestamp NULL DEFAULT NULL,\n  `updated_at` timestamp NULL DEFAULT NULL,\n  `contest_submits` bigint DEFAULT NULL,\n  `group_submits` bigint DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  KEY `submits_contests_submits` (`contest_submits`),\n  KEY `submits_groups_submits` (`group_submits`),\n  CONSTRAINT `submits_contests_submits` FOREIGN KEY (`contest_submits`) REFERENCES `contests` (`id`) ON DELETE SET NULL,\n  CONSTRAINT `submits_groups_submits` FOREIGN KEY (`group_submits`) REFERENCES `groups` (`id`) ON DELETE SET NULL\n) ENGINE=InnoDB AUTO_INCREMENT=[Redacted by tbls] DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin"},{"name":"task_results","type":"BASE TABLE","comment":"タスク(タグ)ごとの結果を管理するテーブル","columns":[{"name":"id","type":"bigint","nullable":false,"default":null,"comment":"タスク結果ID(PK)","extra_def":"auto_increment"},{"name":"request_per_sec","type":"bigint","nullable":false,"default":null,"comment":"秒間リクエスト数(これの総和がスコアになる)"},{"name":"status","type":"varchar(255)","nullable":false,"default":null,"comment":"ステータス。proto に定義されている。"},{"name":"error_message","type":"varchar(255)","nullable":true,"default":null,"comment":"エラーメッセージ"},{"name":"url","type":"varchar(255)","nullable":false,"default":null,"comment":"提出の URL"},{"name":"method","type":"varchar(255)","nullable":false,"default":null,"comment":"http method(使われていない)"},{"name":"request_content_type","type":"varchar(255)","nullable":false,"default":null,"comment":"request Content-Type(使われていない)"},{"name":"request_body","type":"varchar(255)","nullable":true,"default":null,"comment":"request body(使われていない)"},{"name":"thread_num","type":"bigint","nullable":false,"default":null,"comment":"使われたスレッドの数(使われていない)"},{"name":"attempt_count","type":"bigint","nullable":false,"default":null,"comment":"そのタスクでリクエストが行われてた数(使われていない)"},{"name":"created_at","type":"timestamp","nullable":false,"default":null,"comment":"作成日時"},{"name":"deleted_at","type":"timestamp","nullable":true,"default":null,"comment":""},{"name":"submit_task_results","type":"bigint","nullable":true,"default":null,"comment":""}],"indexes":[{"name":"task_results_submits_taskResults","def":"KEY task_results_submits_taskResults (submit_task_results) USING BTREE","table":"task_results","columns":["submit_task_results"],"comment":""},{"name":"PRIMARY","def":"PRIMARY KEY (id) USING BTREE","table":"task_results","columns":["id"],"comment":""}],"constraints":[{"name":"PRIMARY","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"task_results","referenced_table":null,"columns":["id"],"referenced_columns":null,"comment":""},{"name":"task_results_submits_taskResults","type":"FOREIGN KEY","def":"FOREIGN KEY (submit_task_results) REFERENCES submits (id)","table":"task_results","referenced_table":"submits","columns":["submit_task_results"],"referenced_columns":["id"],"comment":""}],"triggers":[],"def":"CREATE TABLE `task_results` (\n  `id` bigint NOT NULL AUTO_INCREMENT,\n  `request_per_sec` bigint NOT NULL,\n  `status` varchar(255) COLLATE utf8mb4_bin NOT NULL,\n  `error_message` varchar(255) COLLATE utf8mb4_bin DEFAULT NULL,\n  `url` varchar(255) COLLATE utf8mb4_bin NOT NULL,\n  `method` varchar(255) COLLATE utf8mb4_bin NOT NULL,\n  `request_content_type` varchar(255) COLLATE utf8mb4_bin NOT NULL,\n  `request_body` varchar(255) COLLATE utf8mb4_bin DEFAULT NULL,\n  `thread_num` bigint NOT NULL,\n  `attempt_count` bigint NOT NULL,\n  `created_at` timestamp NOT NULL,\n  `deleted_at` timestamp NULL DEFAULT NULL,\n  `submit_task_results` bigint DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  KEY `task_results_submits_taskResults` (`submit_task_results`),\n  CONSTRAINT `task_results_submits_taskResults` FOREIGN KEY (`submit_task_results`) REFERENCES `submits` (`id`) ON DELETE SET NULL\n) ENGINE=InnoDB AUTO_INCREMENT=[Redacted by tbls] DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin"}],"relations":[{"table":"submits","columns":["contest_submits"],"cardinality":"Zero or more","parent_table":"contests","parent_columns":["id"],"parent_cardinality":"Zero or one","def":"FOREIGN KEY (contest_submits) REFERENCES contests (id)","virtual":false},{"table":"submits","columns":["group_submits"],"cardinality":"Zero or more","parent_table":"groups","parent_columns":["id"],"parent_cardinality":"Zero or one","def":"FOREIGN KEY (group_submits) REFERENCES groups (id)","virtual":false},{"table":"task_results","columns":["submit_task_results"],"cardinality":"Zero or more","parent_table":"submits","parent_columns":["id"],"parent_cardinality":"Zero or one","def":"FOREIGN KEY (submit_task_results) REFERENCES submits (id)","virtual":false}],"functions":[],"driver":{"name":"mysql","database_version":"8.0.37","meta":{"dict":{"Functions":"Stored procedures and functions"}}}}
